# OTTERMCUMusicBox
The device interfaces with switches, buttons, a seven‑segment display, a set of LEDs, and a piezo buzzer through dedicated I/O addresses. The processor continuously polls the switch settings to determine the user’s song selection and relies on an interrupt, generated by a debounced BTNL button, to start playback and BTNC to reset the device. During playback, the seven‑segment display indicates the selected song (displaying “1” for the Pink Panther Theme song and “2” for Twinkle Twinkle Little Star), while the LEDs provide real‑time visual feedback for each note played. The design meets the needs of users seeking a compact and interactive musical device that demonstrates the integration of digital logic and embedded software.
Operating Instructions
When the Digital Music Player is powered on, the device immediately initializes its internal state. The processor sets up its stack, configures its base memory‑mapped I/O addresses, and enables interrupts by setting the proper bit in the mstatus register. Once initialized, the device enters a polling loop where it reads the switch settings. The LEDs are driven by the song routines to provide momentary visual cues for each note as it is played.
To operate the device, the user first sets the switches to the desired song selection. The seven‑segment display will then indicate the selection: it displays “2” when Twinkle Twinkle Little Star is selected and “1” when the Pink Panther Theme song is chosen. However, no sound is produced until the user presses the BTNL button. Pressing BTNL triggers an interrupt that causes the processor to re-read the switch settings and, based on the selection, execute the appropriate song routine. As the song plays, the software temporarily drives the LED output to unique patterns corresponding to the current note. Each LED pattern is cleared after the note’s duration has elapsed, ensuring that the LEDs light only during active note playback. The piezo buzzer outputs the audible tone corresponding to each note, and once the song completes, the speaker is turned off and the device returns to its idle polling state. The BTNC button reset the device to its original polling state, allowing the user to play another song or repeat the same song selection. 

Software Design
The software design is based on a RISC‑V machine‑code program that is loaded into the OTTER’s instruction memory. At startup, the processor initializes the stack pointer and configures the base MMIO pointer. It then enables interrupts and sets the interrupt vector (mtvec) to point to its interrupt service routine (ISR). The main program enters an infinite polling loop where it reads the DIP switch values; however, no LED output occurs in this loop. Instead, when the user presses the BTNL button, an interrupt is generated. The ISR reads the switch value and determines which song to play. Depending on the value (1 or 2), the ISR writes a corresponding value to the seven‑segment display—displaying “2” for Twinkle Twinkle Little Star and “1” for the Pink Panther Theme song—and then calls the appropriate song routine.
Each song routine is organized into multiple subroutines that play different segments of the tune. For every note played, the software first writes a specific debug pattern to the LED register to indicate that the note is active. The program then writes the note code to the speaker register and calls a delay routine to maintain the note for a predetermined duration. After the delay expires, the LED is explicitly turned off. The delay routines are implemented as single-loop busy‑wait routines, with counts chosen to achieve the desired audible durations. This modular design makes it easy to adjust note lengths or modify the song structure, and the use of separate routines for LED control, note output, and delays keeps the software organized and maintainable.
A comprehensive flowchart accompanies this design, illustrating the main program flow from initialization through interrupt handling, song selection, and note-by-note execution. Additional flowcharts detail the structure of the individual song routines, such as those for the Pink Panther Theme song and Twinkle Twinkle Little Star, showing how each subroutine cooperates to produce the final musical output.

